---
title: PHP CGI Windows平台远程代码执行漏洞(CVE-2024-4577)分析
date: 2024-06-19 20:30:17
categories: [安全研究,漏洞分析]
tags: 
- PHP
- RCE
- CVE
excerpt: 介绍环境搭建，分析该漏洞的成因，原理，以及使用场景并编写EXP。
---

# 背景知识

## CGI

**CGI** 全称：Common Gateway Interface, 中文名：通用网关接口

CGI（Common Gateway Interface）是一种协议，定义了Web服务器与外部程序（如脚本或应用程序）之间的交互方式。它允许Web服务器通过运行外部程序生成动态内容。CGI脚本通常用来处理表单输入、查询数据库或生成动态页面内容。也有定义说CGI属于是一种**接口规范**，它让 **WEB 服务器** 能够执行外部程序，这些外部程序可以是各种不同的语言编写的程序，例如 `.php`, `.asp`, `.jsp`。(这里的 **WEB 服务器** 指的是例如 Nginx 或 Apache 这样的程序)。

举个例子，当一个 URL 请求发送给服务器时，例如：`https://xxx.com/index.php` 我们请求的是 `/index.php` 这个文件，它的`后缀名`会被 Web 服务器程序读取。因为后缀名是 `.php`，那当然就是调用 PHP 的 CGI 程序啦。例如，此刻 Apache 会携带客户端 HTTP 请求时给的参数去调用 `php-cgi.exe`，然后将程序执行的结果响应给客户端。

另外的解释：对 Web 服务器程序调用**其他程序**的规则所做的定义就是 CGI，而按照 **CGI 规范**来工作的程序就称为 **CGI 程序**。

## FastCGI

**Fast**CGI 全称：Fast Common Gateway Interface, 中文名：**快速**通用网关接口。

# 环境搭建

虚拟机：Windows 10 x64

PHP开发环境：[XAMPP](https://www.apachefriends.org/)





